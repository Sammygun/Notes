Протокол ssh
========================
Алиасы и доп информация 
ssh
cd .ssh 
mkdir Docker
ssh-keygen -t rsa
cat .pub ## смотри в данном формате в файле ключь 
копируй все содержимое и используй там где нужно

В дирекории .ssh
vim config
host vs                 # vs 
    hostname     79.143.29.100
    user         root 
    identityFile  ~/.ssh/Docker/vscale

ssh vs ## теперь подключение к серверу таким способом происходит

ssh-keygen -t rsa
## github указывай конкретное для чего ты делаешь данны ключ тогда для разных сервисов удобно делать разные ключи!!!!
cat github.pub | pbcopy ## скопирую все содержимое в буфер обмена потом просто вставлю!!!!!!
=======================
ssh alias
1 vim ~/.ssh/config
Host dev
Hostname dev.sale.com    # можно ip здесь указать
User root
Port 22

2 ssh dev    # теперь могу так логиниться
===========================

Итого:

1 cat id_rsa.pub » -/.ssh/authorized_keys ## добавляем свой публичный ключ >> c новой строки, а не переписать >
2 ssh -p 2222 igot@192.169.0.1 ## если стандартный порт изменен с 22 на 2222

Копирование ключа
1 ssh-copy-id -i .ssh/id_rsa.pub admin@10.0.1.6 # copy-id что именно копировать -i  .ssh/id_rsa.pub конкретный путь ключа оптравил публичный ключь
2 cat .ssh/authorized_keys # на сервере 10.0.1.6 куда отправлял id_rsa.pub появиться ключ в данном файле

3 ssh-add # просто введешь фразу и все на сеанс больше не надо ее вводить

SCP!!!!
4 scp text.txt vasya@10.0.1.16:/home/sam # копирую файл по scp на удаленный комп

5 scp admin@10.0.1.6:/home/admin/secret.file /home/sam  #здесь качаю с удаленного сервера себе на комп все тоже самое только задом на перед


====================================
1 когда ты подключаешься по ssh к серверу ты подключаешься к его ssh-серверу

2 Установка на сервере 
1 sudo apt-get install openssh-server
sudo apt-get install ssh ## установит openssh-server как зависимый пакет

2 sudo vim /etc/ssh/sshd_config ## здесь можно настраивать конфиг ssh

3 Способы подколючения 
1 sudo adduser # можно создать пользователя и по нему подключатся
далее просто будет просить системный пароль пользователя при подключении к серверу извне, пароль его в самой этой системе

2 способ сервер ssh.softime.ru к примеру пользователь на сервере igor
home/isgor/.ssh/authorized_keys ## .ssh если нету можно и создать authorized_kays это файл
cat id_rsa.pub » -/.ssh/authorized_keys ## добавляем свой публичный ключ >> c новой строки, а не переписать >

ssh igor@ssh.softtime.ru ## подключение по имени пользователя и хоста без пароля
Для каждого пользователя свой уникальный authorized_keys надо создавать в его уникальной директории его .ssh

4 /etc/ssh/sshd_config
	1 PasswordAuthentication yes # можно по паролю
	2 PermitRootLogin no ## то есть к серверу нельзя подключаться по ssh через root пользователя, на сервере можно переходить в root командой su

	3 Port 2222 ## по умолчанию порт 22 но существует большое количество сканеров которые взлом делают по порту 22 поэтому меняю на 2222
 	4 Port 2222 ## так делаем чтобы сервер ssh прослушивал сразу по двум серверам
 	  Port 6789 

5 Управление сервером
1 sudo service ssh start ## стартуем ssh сервер
2 sudo service ssh restart ## перезапуск сервера
3 sudo service ssh reload # перечитать измененный конфигурационный файл сервера ssh не останавливая его 
4 sudo service ssh stop # остановка сервера командой stop
5 ps aux | grep sshd # проверка работает ли данный сервер d (daemon)

6 Клиент ssh 
ssh igor@ssh.softtime.ru # подключение по домену
ssh igot@192.169.0.1 # подключение по ip-адресу 

Если по ip и первый раз то сервер может спросить подтверждение пользователя, который удаленно подключается если он согласен, то тогда сохранит адрес удаленного хоста в .ssh/known_hosts

Но если ты попробуешь подключится по ssh по домену может ругнуться и попросить удалить запись
.ssh/known_hosts
ssh-keygen - R ssh.softrime.ru ## удаляю предыдущую запись


7 Можно выполнять команды по ssh пример
ssh igot@192.169.0.1 "ls -la" # если пробел то в кавычки "ls -la" просто выведит результат команды и закроет ssh
ssh igot@192.169.0.1 uptime #  увижу результат данной команды

8 ssh -p 2222 igot@192.169.0.1 ## если стандартный порт изменен с 22 на 2222
====================================================================

9 Настройка ssh клиента

/etc/ssh/ssh_config # это общий config который правится root
touch .ssh/config # создаю config для конкретного пользователя в его директории /home/igor/.ssh

Псевдонимы
.ssh/config


Host node1  
Hostname dbOO.test.clav # название ip adress, домен
Port 2222
User igor
Host node2
Hostname dbOl.test.clav # # название ip adress, домен
Port 2222
User igor

Теперь подключение по ssh
ssh node1 
ssh node2 
Вместо того чтобы вводить:
ssh -p 2222 igor@dbOO.test.clav
ssh -p 2222 igor@dbOl.test.clav

===============================================
10 Доступ по ключу
1 ssh-keygen -t rsa
.ssh появятся ключи 
id_rsa # закрытый ключ пусть всегда на компьютере остается
id_rsa.pub # публичный ключ
cat id_rsa.pub » -/.ssh/authorized_keys # на самом сервере закидываешь вот так и все норм 

11 чтобы постоянно не вводить парольную фразу:!!!!!!!!!!! парольная фраза надо что если кто-то украдет то все равно доступа не будет к ключу публичному

ssh-add # просто введешь фразу и все на сеанс больше не надо


12 массовое выполенине команд на нескольких серверах
1 sudo get install dsh
2 dsh -m igor@192.168.0 . 1 -m igor@192 . 168 . 0.2 -m igort@192.168.0.3 uptime ## выполнение одной команды на нескольких серверах
3 /etc/dsh/groups # если сделать вот так 
igort@192.168.0.1
igort@192.168.0 . 2
igort@192.168.0.3

4 dsh groups uptime # теперь могу выполнять команду таким способом!!!!

5 /etc/dsh/machines.list ### елси указать имя группы groups то команду можно сократить:
dsh uptime


13 Передача файлов по scp:
1 scp id_rsa.pub igor@l92.168.0.l:/home/user/.ssh/id_rsa.pub ## передаю с своего компа на сервер в конкретную папку

2 ssh-copy-id -i .ssh/id_rsa.pub admin@10.0.1.6 # copy-id что именно копировать -i  .ssh/id_rsa.pub конкретный путь ключа оптравил публичный ключь

3 cat .ssh/authorized_keys # на сервере 10.0.1.6 id_rsa.pub появиться ключ в данном файле 

4 scp text.txt vasya@10.0.1.16:/home/sam # копирую файл по scp на удаленный комп

5 scp admin@10.0.1.6:/home/admin/secret.file /home/sam  #здесь качаю с удаленного сервера себе на комп все тоже самое только задом на перед

==============================================
!!!!ssh подключения без пароля к хостингу!!!
1. ssh-keygen -t rsa
2. cd .ssh
3. id_rsa.pub (публичный ключь)  id_rsa(закрытый ключь)
4. ssh-copy-id -i .ssh/id_rsa.pub host0401@vh113.hoster.by ## надо запускать не находясь в папке .ssh
5. ssh-copy-id -i id_rsa.pub host0401@vh113.hoster.by   ###   находись в директории .ssh/ тогда запускать такую команду
6. везде еnter, но если хочешь парольная фразу вставь
7. теперь просто:
ssh host0401@vh113.hoster.by



=================================================
ssh подключения
Пример jenkins

1.ssh-keygen # генерирум ssh
enter
enter # парольная фраза не нужна
enter
2.  cat .ssh/id_rsa.pub # смотрю ssh сгенерированный ключь

ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDB2uJjmYRKdFu9mVQ1AcycFoBI2t+jlb3BtnRfd+3DIdYYo2AncDEmbmZ30uu9465CjkDhSojdw+FLv5/SZrj5PlaNvUs34UoyDfTnDrwIzMxCy/aEvDvGRYJvEiOz4WN8Z6EZ2/y2oMaqMICjKDG6VAQ4bctDL7rOQrqx530TF+Ms/aqX/Kn6CQCE6kJ+yEUnIOorXSkJiXWe8dZcUNyFYQP6Rv73grjhUbm0MmxDs/8nze3Rs1Sk1M3b49tgFPeDC2fD/iI5yM9XB9HemcK8AAWD7uJyf+12eL1YoM886BV4m1CGI4uwRC5Sl+PZFpJpv4NRHsK90IdmNdjenb4z jenkins@ubuntu

# копируй
3. захожу на другой сервер
ssh vasya@192.168.0.102
sudo -i # jenkins получит права рут
vim .ssh/authorized_keys # захожу вставляю ssh ключь сохраняю shift +
=================================================================

ssh аутефикация на github
В самом github в проекте = справо code = тут можно выбрать ssh https
1 ssh-keygen
2 cd .ssh 
3 cat id_rsa.pub копирую все ctrl + a просто все копирую
4 иду на github в правом в верхнем углу user = setings = ssh and gpg keys = new key = название My ssh key = сам ключь вставляй полностью = add new key 
Пример:
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDAmUQ2aCuaaZJPBUbebh2cdXH92ANRiWK2KjQEnK5loltE9LOS6xCJJ4EcUDu/PD+HOFBhSdjeZLkhvdFHb2vh+ihveSQjDuPoFD+3Cp/OMFa3bRQ4H3MYrpv5zyn2WtvPisYjnqyIOJuaHxc7b/fCXdVStMnCCI2JPDIfsBlKDZhHcmUNbwWzkxqnbKD24CJDtNLAHNqjzwDodUOwruuE1n2oDipH3hSL3I9fst+JZ2vHKmWCcJf1RQVRNyiqQcHtmRD+REv1LW4ajIDmLp7wBv4f+jjOjWcIsKmM+O3VxYJFJD9DoQHXyHIyK3L0VQazcF8G1vK7KEMTiCJxZN343zdhARWpAI+PNtpsWR7agVgY5l9HWl7RgKhR+k648sq0yD2rI2+sYznounnT/ak6lTZoIzqbrgQdpvGC2G7UvHFwH+05NuZUbGYoYJ6W8rXWb1rrTq4c18yjl1qrR5gLhR/FWAvxN+H0BWZIRkenNhN9cz8r6p9nl2FJSzZdKDU= sam@sam-Think
5 все теперь когда создаю проект выбираю sshhttp://pythontutor.ru/