Linux Колисниченко
Глава 1 -2
1 Centos, Debian для сервера
2 32 битной системе работает стабильней но если более 4 гб оперативной памяти необходимо PAE-ядро
3 дистрибутивы Debian, ubuntu, opensuse
4 Lts long term support до 5 лет поддержка
5 Сначала на диске должно быть не размеченное пространство,  потом ставишь windows, потом Linux
6 Linux fat32 или ntfs не поддерживает, поддерживает ext3-ext4 (xfs идет для сервера)
7 раздел подкачки 2-4 Гб
8 logout # выход из консоли
exit ## выход
poweroff
shutdown -h 19:30 ## в конкретное время
shutdown -r now # перезагрузка
Глава 3
Gnome KDE
1 sudo apt-get install kubuntu-desktop ## kde альтернативный графический интерфейс
sudo apt-get install kubuntu-fulll ## c полным набором
2 sudo apt-get install uduntu-desktop ### установка графического интерфейса на сервер !!!!!!
3 Параметры системы = яркость блокировка ## отключении автоблокировки
Параметры = Клавиатура  = Комбинации клавиш ### тут настраваю!!!!!
win + пробел по умолчанию переключение языка !!!!!!

Отключение не нужных сервисов
1 sudo apt-get install bum #### настройка сервисов
81 страница какие сервисы можно отключить для ускорения работы !!!!
ClamAV ### это бесплатный антивирус

Аварийные комбинации клавиш
1 Сtrl + Alt + Del #обычная перезагрузка системы  файл смотри /etc/inittab тут его настройка
2 Сtrl + Alt + Backspace ### аварийное завершение графической подсистемы
3 Alt + SysRq + K ##все запущенные процессы убивают !!!!!!!!!!
4 Alt + SysRq + E ## все процессы кроме ядра init получают sigterm 15 (мягкое отключение) !!!!
потом надо будет заново запускать /sbin/init 3 или /sbin/init5
5 SysRq ## если клавиша не работает зайди в /etc/sysctl.cnf
kernel.sysrq = 1  # Добавь строку без ничего и  перегрузи систему

Практические приемы работы с консолью
1 Tab ## подсказки один раз или два раза если подсказка не очевидна
2 man имя программы
3 файл .bash_profile
alias псевдоним='команда'
Пример
alias cfg-net='system-config-network' # сохрани выйди из консоли и зайди
4 echo "some text" > file.txt ### создаст  или  перезапишит записав результат команды в данный файл file.txt
echo "more text" >> file.txt ## добавит дополнительную строку не трогав основной текст файла
5 cat big_text | more ## постраничный вывод файла
less big_text ## Тоже самое но лучше постраничный вывод файла
6 echo y | rm file.txt ## rm спросит можно ли но echo ответит yes за нас !!!!!!!
dad
Файловая система Linux
ext4!!!!
Самые распространенные для сервера и для домашнего компьютера ext3 ext4, наиболее удобно восстанавливать в случае чего много ПО (или Reiser, XFS)
есть файловые системы которые пишут журналы можно в случае чего восстановить

Виды
1 Reiser3 самая экономная но не устойчивая к сбоям
2 Reiser4 замена Reiser3 но так и не стало успешной
3 XFS мощная быстрая fedora рекомендует для сервера хороша для файлов большого размера
4 ZFS Файловая  снапшоты есть для восстановления данных в случае чего+
5 Btrfs opensuse интегрирована есть снапшоты
6 JFS хороша на сервере баз данных

7 В linux есть файлы устройств, которые позволяют обращаться с устройствами как с файлами
/dev/mouse файл мышки
/dev/sdx  файл жесткого диска
8 в linux есть корень файловой системы /dev/sda3 # помечается как палка / другие разделы можно подмонтировать к этой файловой системе
8 Стандартные Каталоги linux
/ - корневой каталог
/bin  - стандартные программы linux (cp, ls ,login и т.д.)
/boot - каталог загрузчика, может содержать конфигурационные файлы загрузчика
/dev - файлы устройств
/etc  содержит конфигурационные файлы системы
/home содержит домашние каталоги пользователей
/lib библиотеки и модули
/lost+found - восстановленные  файлы после некорректного размонтирования файловой системы
/misc может содержать все, что угодно равно как каталог /opt
/mnt - обычно содержит точки монтирования
/proc - информация о процессах
/root - каталог суперпользователя
/sbin(root) каталог утилит которые может выполнять только суперпользователь
/tmp - каталог для временных файлов
/usr - программы пользователя исходный код ядра
/var - постоянно меняющиеся файлы системы почтовые ящики, печать

9 Команды для работы с файлами
1 touch file.txt # создаю файл
2 echo "some text" > file.txt # записываю инфу some text в файл в file.txt
3 cat file.txt ## читаю файл file.txt some text
4 cp file.txt file-copy.txt ### создаю копию файла
5 cat file-copy.txt ###  читаю файл file.txt some text
6 rm file.txt ## удалил
rm s?? ### удалить все файлы имена которых состоят из трех букв начинаются на s
rm *tmp ## удаление всех файлов с таким расиширением
rm  * # удаление всех файлов в папке
7 cat file.txt ### ошибка при чтении его уже нету
8 mv file-copy.txt  file.txt ### переименовал в file.txt
9  cat file.txt ## читаю файл file.txt some text все норм

10 Работа с каталогами
1 mkdir каталог ## создал каталог
2 cd каталог ## перешел в него
3 ls каталог ### посмотрел содержимое
4 rmdir каталог ## удалил каталог
5  rm -r каталог ### удаление каталога
6 . # Текущая папка
cat ./file.tx # читать данный файл именно с текущей директории
7 .. ## Родительский каталог
cd .. ## переход на папку вверх
8 cd ~/dir/  # можно так а можно как ниже
cd /home/den/dir
9 cp-r db public_html ### создаю копию папки совсем ее содержимым и называю ее public_html
mv -r тоже можно использовать

11 Команда Ln
ln file.txt link1 ### жесткая ссылка если удалить file.txt то и link2 ##полноценная копия файла
ln -s file.txt link2### ярлык  если удалить file.txt то link2 поломается

12 Права доступа владелец файла
r-- r-- r-- # владелец группы остальные
если папка то d в начале
dr-- r-- r--
rwx rwx rwx  777  все права читать менять запускать
chmod +x script ### права выполнения скрипта
chmod -x script ### забрал права

chown пользователь название файла
смена владельца файла

12 Монтирование файловых систем
каждое устройство это файл
1 mount (опции) устройство точка монтирования (точка монтирования любая реальная папка откуда можно будет увидеть содержимое устройства, папка должна быть в корневой файловой системе )
sudo mount /dev/scd0 /mnt/cdrom ### /dev/scd0 это устройство монтирую компакт диск в папку cdrom, mnt относится корневой файловой системы
cdrom ### Теперь в этой папке файлы компакт диска
umount  устройства или точки монтирования
umount /dev/scd0 ## размонтировал
umount /mnt/cdrom ### можно и так тоже
Флешки как правило автоматом монтируется в директорию media, раньше mnt
mount /dev/sdb1 /mnt/usbdisk ### монтирование флешки, /dev/sdb1 это устройство
2 udev  менеджер устройств
/dev/sda1 ## это аналог диска С
/dev/sda2  или /dev/sda3 это могут дополнительные диски но не всегда
/sbin/fdisk /dev/sda ### чтобы узнать номер дисков p потом это вводи(возможно сокращено print)

3 Основные опции mount -t -r -w -a
1 mount - t файловая система устройство точка монтирования
mount -t iso9660 /dev/sdc/ /mnt/cdrom # t задает файловую систему iso9660 это вид файловой системы сам cd-disk как правило mount автоматом но все таки
Основные файловые системы:
ext2, ext3, ext4 файловая система linux
iso9660 указывается при монтировании CD-ROM
vfat - FAT, FAT32 windows
ntfs - windows
ntfs-3g ## window
2 r флаг монтирует только в режиме чтения
mount -r /dev/scd0 /mnt/cdrom
   w  флаг чтение запись
mount -w /dev/scd0 /mnt/cdrom
   a монтирование всех файловых систем, указанных в /etc/fstab
mount -a /dev/scd0 /mnt/cdrom

4 Длинные имена получения
места где можно получить нужную информацию
ls -l /dev/disk/by-uuid
ls -l /dev/disk/by-id
ls -l /dev/disk/by-label

Пример
Вставляю флешку и ввожу в терминале смотрю длинное имя
ls -l /dev/disk/by-id | grep usb

EXT4 Лучше всего быстрей, большого размера файлы

5 Разметка диска gparted или fdisk стр 125
fdisk имя устройства
Пример fdis /dev/sda
p
n  # уточнит тип раздела
1
1
GPT помогает восстанавливать файлы информацию стр 127

Глава 5
Bash сценарий запускается с файла .bashrc (в домашнем каталоге пользователя)
.bash_history ## хранится история  команд введенных пользователем


Глава 5 Командный интерпретатор  bash
1#!/bin/bash      ###указываю какой программой должен запускать
echo "Привет мир!"
# коментарий
Сохраняю файл hello
2 chmod +x hello ## даю право на выполнение
./hello ## запуск скрипта
3 чтобы запускать как обычную утилиту через hello
cp ./hello /usr/bin
3 переменная=значение
Address=www.dkws.org.ua
exho $Address ### вызов перемененной $
read Address ### читаю значение переменной
Массивы
ARRAY[0]=1
ARRAY[1]=2
echo $ARRAY[0]
Циклы
for переменная in список;
do
команды;
done
Пример
for n in 1 2 3;
do
echo $n;
done
вывод
1
2
3

while условие
do
команды
done
ПРИМЕР
n=1
while [ $n -lt 4 ] ###  -lt меньше
do
   echo "$n "
   n=$( ( $n+1 ) );
done

if условие_1 then
       команды_1
elif условие_2 then
        команды
...
elif условие_N then
       команды_N
else
       команда_N+1
fi

#переменная N = 10
[ N == 10 ]
# переменная N не равна 10
[  N!=10 ]

Глава 6
В Linux могут работать два пользователя одновременно и более не мешать друг другу увидеть это можно через команду
who
ctrl + alt + f1 ## переход в root
sudo команда под привилегиями root
sudo vim /etc/hosts ## как примеру
su ### просто становлюсь рутом сразу потом когда не надо exit
sudo -i ## переход в root потом можно вводить любые команды
alt + f2 ## переход в root
Каждая команда sudo записывается в журнал
/var/log/auth.log

sudo passwd root ### меняю пароль root
спросит текущий пароль
попрости ввести  новый пароль
Подтверждение пароля
sudo passwd -l root ### блокирую пользователя

Добавлении пользователя
adduser <имя пользователя> добавляю пользователя
passwd <имя пользователя> добавляю пароль
команды запускаются /usr/sbin
useradd ### в Open suse
usermod  ### модифицирования учетной записи
man usermod
userdel <Имя пользователя > ## удаление пользователя
/etc/shadow ## где пароли хранятся в
$ если шифр начинается то алгоритм DES самый просто
$1$  то это md5 самый простой
/etc/groups ###список групп
/home/<имя пользователя>
при создание пользователя копируется содержимое пользователя с /etc/skel  в  /home/<имя пользователя>
chown -R <пользователя > <каталог >
groupadd ## добавление группы когда два программиста над одним проектом, поэтому и создаются группы у них общий доступ к файлам как пример
/etc/group ### здесь указываются доступные группы
/etc/passwd ## тут тоже можно редактировать группу

Автоматический вход
В ubuntu = Параметры системы = Учетные записи =Автоматический вход
В fedora  = Все параметры = Пользователя = похожи очень

Квотирование пользователей 156 страница

Глава 7 Пакеты и управление пакетами
1rpm пакеты red hat, centos, fedora
deb пакеты Ubuntu,kubuntu,

RPM     http://rpmfind.net  и http://rpm.pbone.net
Deb     http://www.debian.org/distrib/packages   http://packages.ubuntu.com

Установка из исходников
архив программы распаковываем архив желательно в каталог /usr/src
./configure ##проверит есть ли все содержимое если норм создаст файл Makefile
make ###на основании Makefile компилирует программу
make install ### устанавливает программу и дополнительные файлы в каталог /usr/bin а документацию в /usr/share/doc, конфигурационные файлы в /etc  и т.д.
2 dpkg apt  ## debian
rpm red hat fedora open suse
yum  fedora и  другие дистрибутивы
3 yum install пакет
yum remove пакет
yum update ## проверить наличие обновлений
yum update пакет ### проверить конкретный пакет
yum check-update
yum check-update пакет ###  просто проверить наличие конкретного пакета
yum info пакет вывести информацию о пакет
yum list ## смотрю список
yum list a* ### вывести весь список утилит начинающихся на а
yum serach строка ## найти все пакеты которые есть в описании
yum groupinstall "группа" установить все пакеты из указанной группы
yum grouplist  ## вывести список групп пакетов

4 rpm -ihv имя пакета #установка
rpm -e Имя пакета
rpm -U Имя пакета ### обновление пакета
rpm -ga | grep имя пакета ###  смотрю установлен ли тот или иной  пакет
rpm -gi имя пакета ### информацию о пакете
rpm -ql  имя пакета ### список файлов входящих в состав пакета
rpm -qa | grep more #### вывести список все пакетов
5 После yum идет установчик пакетов  dnf 171 страница
6 debian менеджер пакетов dpkg
apt-get install package
sudo gedit /etc/apt/sources.list ## перечислены источники репозиториев
чтобы установка работала быстрей в этом файле меняю:
archive.ubuntu.com на ru.archive.ubuntu.com
6.1 если захочу поставить rpm пакет в ubuntu
sudo apt-get intall alien ### сначало alien устанавливаю
sudo alien package_file.rpm ####потом через него ставлю rpm пакеты
6,2 sudo apt-get install synaptic ### установка менеджеров пакетов графический интерфейс очень удобный
6.3 если при установке в debian ubuntu какая-то проблема делай
sudo apt-get update ## или пробуй ключ fix-misiing
6.4 sudo apt list | grep installed ### смотрю что установлено

Глава 8 файлы конфигурации сети в linux стр 196
Для сети нужны, сетевые карты, коммутатор(switch), кабеля

/etc/aliases ### база данных почтовых псевдонимов  псевдоним пользователь
/etc/hosts.allow ip адреса узлов которым разрешен доступ
/etc/hosts.deny ip адреса узлов которым запрещен доступ
/etc/hostname ### Имя узла в debian ubuntu
/etc/iftab ### содержит таблицу интерфейсов  т.е. соотвествие имен интерфейсов и mac-адресов

1.Networkmanager конфигуратор сети
интерфейсы могут называться eth0, ens33,enp3s0,eth1
2 конфигуратор сети nm-connection-editor
3 Управление сервисом
sudo service network stop
sudo  service network start
sudo  service network restart
sudo   service network status

если ifconfig или service network status отсуствует интрефейс Io значит сервис network остановлен
4 DHCP - сервер 2 -3 компа сеть лучше через него настраивать\
Серверы DNS 8.8.8.8

5 Диагностика проблем в сети
если интерфейс не поднят сразу смотрю
tail -n 10 /var/log/messages ### смотрю хвост протокола 10 сообщений
ping dkws.org.ua ### смотрю ответы
tracepath dkws.org.ua  ### смотрю где обрыв происходит в linux
traceroute dkws.org.ua ### это по новей уже
tracert dkws.org.ua  ##### В  windows
Просто вижу где обрыв происходит.

5.1 Ищу где хранится  имя узла
После того  настроил  Networkmanager захожу в etc и смотрю какой файл не давно менялся по дате изменения

5.2 debian ubuntu
/etc/network/interfaces ##### основной конфигурационный файл
/etc/hostname ### Имя узла в debian ubuntu
/etc/NetworkManager/system-connections ####dsl соединения

hostnamectl set-hostname <имя узла > ##### Меняю имя узла
mii-tool -v eth0 ### смотрю параметры сетевого интерфейса
mii-tool -force=режим интерфейс
mii-tool -force=10baseT-FD eth0 #### устанавлию режим

Помни про DHCP-сервер!!!!!!!

Глава 9 ADSL
/etc/NetworkManager/system-connections/<имя подключения> ### можно посмотреть пароль от соединение при использовании NetworkManager пароль это строка psk
sudo pppoeconf ### тоже настройка adsl
Скрытые беспроводные сети
пример отказоустойчивого подключения к интернету когда есть два разных подключения к интернету и если одно обломится то можно на второе перейти
chmod +x routing ### делаю скрипт (сценарий) исполнимым, пример скрипта 238 страница


Глава 13
sudo mv xorg.conf.new /etc/X11/xorg.conf ### заменяю конкретный файл на который мне нужно
lspci | grep -i VGA #### смотрю видеокарту подключенную по vga


Глава 14
libreoffice ### хорошая программа для офисных программ
Kingsoft office ### преимущество что идет как офисная программа также работает на android
Gimp ### аналог photoshop
Браузер Chromium ### крутая штука
ftp клиент filezila
transmission ### аналог bitorent на linux можно скачивать много чего


командная строка ftp
sudo dnf install ftp ### установка как правило уже установлена fedora
ftp <Имя или адрес ftp-сервера> ### подключение
open <Имя или адрес ftp-сервера> ### включение
ОСНОВНЫЕ КОМАНДЫ
ls
get  ### загрузить с сервераа
put ### Загрузить на сервер
mget ### скачать несколько файлов с сервера
mput ### загрузить несколько файлов на сервер
cd
mkdir
rmdir ## удаление пустого каталога
delete ## удалить файл

Глава 18 virtual box
После установки virtual box надо перезагрузить комп или ввести команду
sudo modprobe vboxdrv ### или такую команду ввести
Динамический виртуальный жесткий диск ### удобно что если выставил 20гб, но по факту 8гб используешь использует то остальные 12 свободны
Фиксированный виртуальный жесткий диск #### ставишь 20 гб и сразу 20 гб используешь
Сеть NAT ### то есть реальный комп станет выступать в качестве шлюза для виртуального наиболее удобный
МОСТ
Аудио###настраиваешь звук на виртуальной машине
ПРАВЫЙ ctrl ### отключает захват клавиатуры виртуальной машины

Глава 20
dmesq | less## информация о загрузке ядра
uname -a # информация о ядре

Глава 21
1 grub grub2 загрузчик linux который позволяет выбрать операционную систему
/boot/grub/grub.conf ## grub
/boot/grub/grub.cfg #### grub2 конфигурационный файл
 2 /sbin/grub-install /dev/sda # установка grub
3 конфигурационные файлы linux можно читать с widnows используя Total commander
4 cp /boot/grub/grub.conf /boot/grub/grub.conf_backup ##создание резервной копии  файла
5 когда сервису А нужен сокет сервиса Б, то это всего лишь файл

Глава 22
service s start     systemctl start s.service    ## разовый запуск сервиса
service s stop   systemctl stop s.service    ## остановить сервис s
service s restart   systemctl restart s.service ### перезапуск сервиса s
system s status     systemctl status s.service # статус сервиса S
systemctl enable s.service ### чтобы после перезагрузки сервис загружался

Глава 23
ALt + F2 ### дополнительный терминал
top ### time время выполнения,     процессорное время
PR приоритет максимальный 20(чем выше тем быстрей будет выполнение процесса ) минимальный 19, приоритет по умолчанию 10
nice -n <приоритет> команда аргументы
renice -n <приоритет> -p PID ###если процесс запущен, то увеличиваем приоритет в реальном времени


Глава 24
cd /proc  = ll
Виртуальная файловая система proc
cat /proc/version ## содержит версию ядра
cat /proc/cmdline # список параметров при загрузке ядру
cat /proc/cpuinfo### информация о процессоре
cat /proc/meminfo ### информация об использовании оперативной памяти аналог free
cat /proc/devices # список устройств
cat /proc/filesystems ## файловые системы которые поддерживаются системой
cat /proc/mounts ### список подмонтированных файловых систем
cat /proc/modules ## список загруженных модулей
cat /proc/swaps ## список файлов подкачки которые активны на текущий момент

Глава 25 Общие команды
1 arch ### архитектура процессора i386, x86
2 clear # очистил экран
3 date ## дата в старой системе 1609161707 ### 16.09.16 время 17:17
4 echo "Hello world! " ### вывод
5 exit ## выход из системы
6 passwd имя_пользователя ### меняю пароль пользователя
7 uptime ## сколько система работает без перезагрузки
8 users ### информация о пользователях подключенных к системе в данный момент
9 w  ### список пользователей подключенных в данный момент время входа статистика использования системы (idle время простоя, JCPU - использования процессора), выполняемые пользователем задачи
who ## список пользователей подключенных к системе время и дату входа для каждого пользователя
whoami # кто я имя пользователя кто ввел эту команду
10  diff параметры файл1 файл2
отличающиеся строки помечаются  > и <
строка из первого файла  <
строка из второго файла >
diff -y файл1 файл2  ## вывод в два столбца

cmp параметры  файл1 файл2  ### более универсальная команда сравнение файлоы
Параметры
-с ## вывод отличающихся символов
-i n ## игнорировать первые n символов
-l  # вывод позиций всех отличий а не только  первого
-s ##не выводить инфу на экран
0 файлы одинаковые
1 файлы отличаются 
2 ошибка при открытии одного из файлов
11 more ## просмотр текстового документа
less # просмотр текстового документа лучше
12 head ## начала файла
 tail #хвост файла
head -n 10 /var/log/messages ## первые 10 строк
tail -n 10 /var/log/messages ## последние  10 строк
tail -f /var/log/messages ###смотрю файл в реальном времени

11 lynx mail.ru##текстовый браузер
12 команды системного администратора
df -h ## использование дискового пространства
free -h ### использование оперативной памяти и виртуальной


ГЛАВА 26
Конфигурационные файлы etc
1 /etc/abrt #automatiun bug detection and reporting tool для разрабов
2 /etc/NetworkManager/system-connections ### NetworkManager программа настройки сети
Тут можно посмотреть пароли имя файла имя соединения c интернетом
3 /etc/crontab
/etc/at.allow ## список команд которые можно вставить
/etc/at.deny ### список команд которые нельзя вставлять и они запрещены список запрещенных команд
touch at.allow ### список разрешенных команд
4 /etc/fonts/fonts.conf ### настройка шрифтов
5 Сервер конфигурации
/etc/ssh/sshd_config  ##ssh сервер
/etc/httpd/conf/httpd.conf  ### web server apache или папка apache
/etc/proftpd/proftpd.conf ## ftp сервер ProFTPD
/etc/bind/named.conf ## DNS сервер
/etc/squid/squid.conf ## Прокси сервер SQUID
/etc/exports  ## NFS NETWORK FILE System
/etc/samba/samb.conf ## Samba доступ к windows сети
6 /etc/mail ## sendmail
7 /etc/ntp ### время
8 /etc/openvpn ### настройка vpn
9 /etc/skel ## при создании пользователя всего его будущие папки берется информация отсюда здесь все настройки
10 /etc/groupe ## группы в системе
    /etc/passwd ###пароли пользователей
     etc/sudoers ## информация кто имеет право sudo

Глава 27 Протоколирование системы ПОМНИ journal + ctl как и system + ctl
https://losst.ru/shpargalka-po-journalctl-v-linux
Демоны программы которые пишут логи сервера
1 journactl 
/var/log #### седа пишутся логи сервера
2 journactl -b ## логи c момента текущей загрузки
3 Все логи пишутся исходя из даты установленной в системе
timedatectl set-timezone  <часовой пояс> ### установка часового пояса
timedatectl list-timezones ## список часовых поясов стрелкой вниз листать
timedatectl  status #  узнать какой часовой пояс сейчас установлен
4  journactl -b ## логи c момента текущей загрузки
    journactl --list-boots ## это список всех загрузок 0 текущая, 1 предыдущая и так далее !!!!!!!!!!!!!!!!!!!!!!!!!!!!
   journactl -b -1  ### смотрю журнал с предыдущей загрузки 
5 Просмотр логов по дате  --since --until
journactl --since "2015-11-11 07:00:00" ## смотрю логи с 11 11 2015 7:00
если не укажу дату то будет взята текущая дата
если указана дата, но не время то будет взято время по умолчанию 00:00:000
6 journactl --since yesterday ##логи с вчерашнего дня по текущий
  journactl --since 09:00 --until now ## логи с 9:00 по текущий момент
  journactl --since 09:00 --until "1 hour ago" ### логи с 10:00 и  до прошлого одного  часа назад если сейчас 19:00 то покажет 18:00 
7 Фильтр по сервису 
journactl -u nginx.service ## логи конкретной службы !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
journactl -u nginx.service --since  yesterday ##логи начиная со вчерашнего дня в примере (today) возможно описка
8 Фильтр по пути 
journactl /usr/bin/docker
9 journactl _PID=<ID процесса> ##фильтр журнала  по конкретном процессу его pid номер
10 можно узнать по uid пользователя его логи что он делал
id ## узнаю здесь  uid
id -u sam ## узнаю конкретного пользователя uid
journalctl _UID=1000  ### все логи конкретного пользователя
journalctl _UID=1000 --since yesterday ## все логи конкретного пользователя со вчерашнего дня
 10 Сообщения ядра
journalctl -k ## сообщения ядра можно и через dmesg тоже вводить  journactl --dmesg
journactl --dmesg
journalctl -k -b -2 ## смотрим логи с предыдущей загрузки
11 ФИЛЬТР по уровню ошибок
 0 EMERG система неработоспособна 
1 ALERT (требуется немедленное вмешательство)
2 CRIT (критическое состояние)
3 ERR (ошибка)
4 Warning (предупреждение)
5 NOTICE (просто обратите внимание)
6 INFO информационное сообщение
7 DEBUG отложенная печать
journalctl -p err -b ### выводит все ошибки при текущей загрузке !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
journalctl -f ## в реальном времени
Можно настроить логи чтобы удаленно находились на конкретной тачке страница 453
8 sudo journalctl -xe ## просмотр логов сервисов различных apache и т.д. !!!
9 sudo journalctl -eu apache2.service  ## конкретный сервис !!!
10 sudo journalctl -list-boots ## всех сохраненных загрузок  !!!!
   sudo journalctl -b 37d5c906c9c6404682f029b2c34ec9dc ### конкретный идентификатор

ГЛАВА 28 обеспечение безопасности сервера
passwd root ## меняю пароль пользователя root
init=/bin/bash ## запуск командного интепретатора
reboot ## перезагрузка
shutdown ## выключение
Установка пароля на загрузчик grub 21.8 раздел 389 страница
/etc/sudoers ## тут могу настроить или посмотреть как запускать sudo
den localhost = NOPASSWD: /bin/kill, /sbin/reboot, /sbin/halt # den может от sudo запускать эти команды (kill reboot halt) без пароля root
den localhost = PASSWD: /bin/kill, /sbin/reboot, /sbin/halt ## тоже самое что выше только будет просить пароль учетной записи Den

/etc/passwd
root:x:0:0:root:/root:/bin/true ###теперь все если кто-то узнает пароль root то он все равно не попадет в систему


ГЛАВА 29
1 /etc/security
access.conf
-:ALL EXCEPT root den admin:All
Запретить регистрацию кроме root den admin
2 -:ALL EXCEPT root: 192.168.1.2 ## доступ возможен только с конкретного ip
   -:ALL LOCAL ### локальный доступ любой запрещен
ЧТОБЫ все заработало
Нужно в файлы /etc/pam.d/system-auth и /etc/pam.d/sshd  вставить следующую строку:
account required /lib/security/pam_access.so
account required /lib64/security/pam_access.so #для 64 битной системы

crond ## планировщик задач
минуты (0-59)  часы (0-23)  день (1-31) месяц (1-12) день недели(0-6, 0-Вс)
0 7 * * * /usr/bin/command1 arguments ### каждый день в 7 утра
20 7 * * * /usr/bin/command1 arguments ### каждый день в 7:20 утра

etc/cron.hourly ## сюда забрасываешь планировщик задач
etc/cron.daily/ ##    
Anacron родсветнник у него немного другая настройка если сервер отключился и включили то все задачи выполнятся в отличии от crond
crond лучше

Разовое выполение команд atd
at вермя дат
at 2pm ## выполнить сегодня в 14:00
dig a linux.by ## список команд
ctrl + D ### когда закончил ввод команд
atq ## очередь команд
atrm ### удалить какое либо задание

iptables
INPUT  ## для входящих пакетов
OUTPUT ## для исходящих пакетов
FORWARD ### для транзитных пакетов
имя цепочки пакет будет отправлен в цепочку с этими именем
Accept принять пакет
Drop ## отбросить пакет
Masquerade ## маскарад скрыть ip адрес пакета 
sudo iptables -P INPUT DROP### входящий отбрасываем
sudo iptables -P FORWARD ACCEPT ### транзитный отбрасываем
sudo iptables -P OUTPUT DROP ## изсходящий отбрасываем
https://ru.wikipedia.org/wiki/Iptables ВИКИПЕДЕЯ ХОРОШАЯ статья по iptables
http://opennet.ru/docs/RUS/iptables/ ## крутое руководство по iptables

шлюз ## это локальный комп  который предостваляет доступ к интернету
шлюз выполняет маршрутизацию пакетов
Маршрутизация это процесс перенаправления пакетов по сетям находящимся между отправителем и получателем



Глава 32 SSH
/etc/ssh/sshd_config ## здесь настройки
service sshd start
service sshd stop



Глава 33 Apache
1 Менеджер пакетов Synaptic
2 /var/www/html
3 test.php ## запуск домен/test
<?php
phpinfo();
?> ### проверка php
3 конфигурационные директори
etc/apache2 ## ubuntu debian
apache2.conf
etc/httpd ### red hat семейства
httpd2.conf
4 файле apache2.conf
ServerName название домена
5 ports.conf ### порты
ServerRoot ### каталог конфигов сервера
DocumentRoot #### место корневой директории сайта
ErrorLog файл ###задает журнал
ErrorDocument N файл ### файл где инфа об ошибке
6 управление web сервером
sudo service httpd start  ## или apache2
sudo service httpd restart ### ## или apache2
sudo service httpd stop ### ## или apache2
7
apache2.conf
Maxclients ### максимальное количество клиентов
StartServers #### задает количество экземпляров сервера лучше настраивать чуть меньше maxclients

8 уставновка Mysql
mysql-server-5.0
mysql-client-5.0
mysql-admin

2 после утсновки
mysql_install_db ## создаст необходимые таблицы
chown -R mysql /var/lib/mysql ### если будет ошибка при вводе mysql_install_db
mysqladmin -u root password ваш_пароль  #### задаст пользователя и пароль


Глава 34 FTP-Сервер
1 sudo service proftpd start
   sudo service proftpd stop
   sudo service proftpd status
   sudo service proftpd restart



ГЛАВА 35  DNS сервер
Свой DNS сервер кэширует  очень долго, ему нужно долгое время чтобы за кэшировать нужные сайты, но можно использовать чужой кэш, к примеру хостинг-провайдера, такие серверы называются форварды.
forwarders {
192.168.99.1; ##все запросы будут переданы данному серверу, если у него в кэше не будет
};
}

SOA описывает полномочия
 Это имя компьютера на котором запущен DNS Сервер, затем следует e-mail администратора сервера без @

ГЛАВА 36 ПРОКСИ-сервер
Основная функция прокси-сервера это кэширование 


ГЛАВА 37  ПОЧТОВЫЙ СЕРВЕР
Почтовый сервер состоит из 2 компонентов: SMTP-сервера(для приема почты от пользователя и отправки другим почтовым серверам) и POP сервера(Получение корреспонденции пользователями)
IMAP загружает заголовки  пришедших ему отправлений, позволяет ему загрузить заголовки писем на комп только тех которые ему нужны
POP сразу же загружает на комп пользователя всю поступившую почту
SMTP протокол отправки
POP IMAP протокол получения 
MUA (mail user agent это почтовый клиент)
MTA (mail transfer agent) программа которая обеспечивает работу пользователя на самом уже сервере (sendmail)
Схема отправки получения писем
MUA (почт. клиент) = отправка письма протокол  smtp = MTA (почтовый сервер) = передача другому серверу = MTA (почтовый сервер) = получения письма (протоколы POP IMAP) (MUA почт. клиент получателя)


ГЛАВА 38 ВИРТУАЛИЗАЦИЯ
OpenVz не поддерживает IPSec OpenVpn, Windows
KVM все это поддерживает
Виртуализация позволяет более рационально использовать параметры сервера


ГЛАВА 39 SAMBA
Позволяет настроить взаимодействие между операционной системой windows linux
Windows пользователи смогут просматривать твои директории на linux, можно настроить и наоборот


ГЛАВА 40 RAID
RAID массив
Объединение 2 винчестеров в один RAID-массив все, что будет записано на первый винчестер автоматически продублируется на второй. Если первый поломается то можно восстановить со второго винчестера все.
Есть аппаратный и программный. Программный более медленный зато включен в linux.
Проверка наличие RAID
dmesg ## как правило включен в linux при загрузке должно быть RAID arrays
raidtools ## Инструменты для работы с raid
raidhotadd ### первая добавляет в него диск
raidhotremove ### удаляет диск из массива
mkraid ## создание raid массива
массив 1 уровня зеркало два диска
 1 Объединим два диска /dev/sda /dev/sdb
Разметка диска /dev/sda ## два раздела  первый раздел подкачки (2 гб), второй все оставшееся дисковое пространство
sudo sfdisk -d /dev/sda | sfdisk /dev/sdb #### копируем такую же разметку на диск  /dev/sdb

sudo mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sda1 /dev/sdb1
sudo mdadm --create /dev/md1 --level=1 --raid-devices=2 /dev/sda2 /dev/sdb2
Первая команда создает RAID массив разделов подкачки  (/dev/md0), вторая разделов данных (/dev/md1)
Первый параметр команды mdadm (--create) указывает, что мы создаем RAID массив за ним следует имя устройства. Параметр --level задает уровень RAID параметр --raid-devices -количество устройств а далее через пробел приводится список устройств формирующих RAID-массив

После этих команд создается два устройства:
 /dev/md0 # для подкачки
/dev/md1 которое будет использоваться для хранения данных
sudo mkswap /dev/md0 setup ### помечаю как устройство подкачки

Теперь устанавливаем систему как обычно, при выборе разделов следует определить устройство /dev/md0 для использования в качестве подкачки, а для устройств задать точку монтирования, загрузчик нужно установить MBR